{"ast":null,"code":"import fetch from 'node-fetch';\nconst SENDGRID_API = 'https://api.sendgrid.com/v3/mail/send';\nconst SENDGRID_API_KEY = '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';\n\nconst sendEmail = async order => {\n  const {\n    token,\n    number,\n    createdAt,\n    payment,\n    status,\n    items,\n    quantity,\n    subtotal,\n    totals,\n    total,\n    billingAddress,\n    shippingAddress\n  } = order;\n  const {\n    firstName,\n    lastName,\n    company,\n    country,\n    email,\n    phone\n  } = billingAddress;\n  debugger;\n  let html = ` <div class=\"order-success__body\">\n    <div class=\"order-success__header\">\n       <svg class=\"order-success__icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\">\n          <path d=\"M50 100C22.4 100 0 77.6 0 50S22.4 0 50 0s50 22.4 50 50-22.4 50-50 50zm0-98C23.5 2 2 23.5 2 50s21.5 48 48 48 48-21.5 48-48S76.5 2 50 2zm-5.8 69L22.3 49.1l1.4-1.4 21.2 21.2 34.4-34.4 1.4 1.4L45.6 71c-.4.4-1 .4-1.4 0z\"></path>\n       </svg>\n       <h1 class=\"order-success__title\">Thank you</h1>\n       <div class=\"order-success__subtitle\">Your order has been received</div>\n       <div class=\"order-success__actions\"><a class=\"btn btn-sm btn-secondary\" href=\"http://royalautopartsmarket.com/\">Go To Homepage</a></div>\n    </div>\n    <div class=\"card order-success__meta\">\n       <ul class=\"order-success__meta-list\">\n          <li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Enquiry number: </span><span class=\"order-success__meta-value\">${number}</span></li>\n          <li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Created At: </span><span class=\"order-success__meta-value\">${createdAt}</span></li>\n          <li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Total: </span><span class=\"order-success__meta-value\">AED${subtotal}</span></li> \n       </ul>\n    </div>\n    <div class=\"card\">\n       <div class=\"order-list\">\n          <table>\n             <thead class=\"order-list__header\">\n                <tr>\n                   <th class=\"order-list__column-label\" colspan=\"2\">Product</th>\n                   <th class=\"order-list__column-quantity\">Quantity</th>\n                   <th class=\"order-list__column-total\">Total</th>\n                </tr>\n             </thead>\n             <tbody class=\"order-list__products\">`;\n  items.map(item => {\n    const {\n      product,\n      price,\n      quantity\n    } = item;\n    const {\n      name,\n      slug,\n      partNumber\n    } = product;\n    const desc = name + ' ' + partNumber + ' ' + slug;\n    html = html + ` <tr>\n        <td class=\"order-list__column-image\">\n           <div class=\"image image--type--product\"><a class=\"image__body\" href=\"http://royalautopartsmarket.com/products/${slug}\"> </a></div>\n        </td>\n        <td class=\"order-list__column-product\"><a href=\"http://royalautopartsmarket.com/products/${slug}\">${desc}</a></td>\n        <td class=\"order-list__column-quantity\" data-title=\"Quantity:\">${quantity}</td>\n        <td class=\"order-list__column-total\">AED${price}</td>\n     </tr>`;\n    return html;\n  });\n  html = html + ` </tbody></table><table>\n    <tbody class=\"order-list__subtotals\">\n        <tr>\n          <th class=\"order-list__column-label\" colspan=\"3\">Total</th>\n          <td class=\"order-list__column-total\">${subtotal}</td>\n       </tr>\n    </tbody>\n   \n </table>\n</div>\n</div>\n<div class=\"order-success__addresses\"> \n<div class=\"card address-card order-success__address\">\n <div class=\"card__loader\"></div>\n <div class=\"address-card__badge tag-badge tag-badge--theme\">Billing Address</div>\n <div class=\"address-card__body\">\n  \n   \n    <div class=\"address-card__row\">\n    <div class=\"address-card__row-title\">name</div>\n    <div class=\"address-card__row-content\">${firstName}</div>\n </div>\n <div class=\"address-card__row\">\n <div class=\"address-card__row-title\">Email Address</div>\n <div class=\"address-card__row-content\">${email}</div>\n</div>\n    <div class=\"address-card__row\">\n       <div class=\"address-card__row-title\">Phone Number</div>\n       <div class=\"address-card__row-content\">${phone}</div>\n    </div>\n    <div class=\"address-card__row\">\n       <div class=\"address-card__row-title\">Email Address</div>\n       <div class=\"address-card__row-content\">${email}</div>\n    </div>\n    <div class=\"address-card__row\">\n    <div class=\"address-card__row-title\">Country</div>\n    <div class=\"address-card__row-content\">${country}</div>\n </div>\n <div class=\"address-card__row\">\n <div class=\"address-card__row-title\">Company</div>\n <div class=\"address-card__row-content\">${company}</div>\n</div>\n </div>\n</div>\n</div>\n</div>`;\n  await fetch(SENDGRID_API, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${SENDGRID_API_KEY}`\n    },\n    body: JSON.stringify({\n      personalizations: [{\n        to: [{\n          email\n        }],\n        subject: 'Enquiry To Royal Auto Parts Market :)'\n      }],\n      from: {\n        email: 'enquiry@royalautopartsmarket.com',\n        name: 'Spare Parts Enquiry'\n      },\n      content: [{\n        type: 'text/html',\n        value: html\n      }]\n    })\n  });\n  await fetch(SENDGRID_API, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n      Authorization: `Bearer ${SENDGRID_API_KEY}`\n    },\n    body: JSON.stringify({\n      personalizations: [{\n        to: [{\n          email: \"bibinprathap@gmail.com\"\n        }],\n        subject: 'Enquiry From Royal Auto Parts Market :)'\n      }],\n      from: {\n        email: 'enquiry@royalautopartsmarket.com',\n        name: 'Spare Parts Enquiry'\n      },\n      content: [{\n        type: 'text/html',\n        value: html\n      }]\n    })\n  });\n}; // value: `<div class=\"order-success__body\"><div class=\"order-success__header\"><svg class=\"order-success__icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"><path d=\"M50 100C22.4 100 0 77.6 0 50S22.4 0 50 0s50 22.4 50 50-22.4 50-50 50zm0-98C23.5 2 2 23.5 2 50s21.5 48 48 48 48-21.5 48-48S76.5 2 50 2zm-5.8 69L22.3 49.1l1.4-1.4 21.2 21.2 34.4-34.4 1.4 1.4L45.6 71c-.4.4-1 .4-1.4 0z\"></path></svg><h1 class=\"order-success__title\">Thank you</h1><div class=\"order-success__subtitle\">Your Enquiry has been received ${name}</div><div class=\"order-success__actions\"><a class=\"btn btn-sm btn-secondary\" href=\"/\">Go To Homepage</a></div></div><div class=\"card order-success__meta\"><ul class=\"order-success__meta-list\"><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Enquiry number:</span><span class=\"order-success__meta-value\">#9479</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Created At:</span><span class=\"order-success__meta-value\">Dec 23, 2020</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Total:</span><span class=\"order-success__meta-value\">AED85.00</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Payment Method:</span><span class=\"order-success__meta-value\"></span></li></ul></div><div class=\"card\"><div class=\"order-list\"><table><thead class=\"order-list__header\"><tr><th class=\"order-list__column-label\" colspan=\"2\">Product</th><th class=\"order-list__column-quantity\">Quantity</th><th class=\"order-list__column-total\">Total</th></tr></thead><tbody class=\"order-list__products\"><tr><td class=\"order-list__column-image\"><div class=\"image image--type--product\"><a class=\"image__body\" href=\"/products/ENGINE-OIL-BMW-5W30\"> </a></div></td><td class=\"order-list__column-product\"><a href=\"/products/ENGINE-OIL-BMW-5W30\">ENGINE OIL BMW 5W30</a><div class=\"order-list__options\"><ul class=\"order-list__options-list\"><li class=\"order-list__options-item\"><span class=\"order-list__options-label\">Material: </span><span class=\"order-list__options-value\">Aluminium</span></li><li class=\"order-list__options-item\"><span class=\"order-list__options-label\">Color: </span><span class=\"order-list__options-value\">Yellow</span></li></ul></div></td><td class=\"order-list__column-quantity\" data-title=\"Quantity:\">1</td><td class=\"order-list__column-total\">AED25.00</td></tr><tr><td class=\"order-list__column-image\"><div class=\"image image--type--product\"><a class=\"image__body\" href=\"/products/ENGINE-OIL-BMW-5W30\"> </a></div></td><td class=\"order-list__column-product\"><a href=\"/products/ENGINE-OIL-BMW-5W30\">ENGINE OIL BMW 5W30</a></td><td class=\"order-list__column-quantity\" data-title=\"Quantity:\">1</td><td class=\"order-list__column-total\">AED25.00</td></tr></tbody><tbody class=\"order-list__subtotals\"><tr><th class=\"order-list__column-label\" colspan=\"3\">Subtotal</th><td class=\"order-list__column-total\">AED50.00</td></tr><tr><th class=\"order-list__column-label\" colspan=\"3\">Shipping</th><td class=\"order-list__column-total\">AED25.00</td></tr><tr><th class=\"order-list__column-label\" colspan=\"3\">Tax</th><td class=\"order-list__column-total\">AED10.00</td></tr></tbody><tfoot class=\"order-list__footer\"><tr><th class=\"order-list__column-label\" colspan=\"3\">Total</th><td class=\"order-list__column-total\">AED85.00</td></tr></tfoot></table></div></div><div class=\"order-success__addresses\"><div class=\"card address-card order-success__address\"><div class=\"card__loader\"></div><div class=\"address-card__badge tag-badge tag-badge--theme\">Shipping Address</div><div class=\"address-card__body\"><div class=\"address-card__name\">bbb nnn</div><div class=\"address-card__row\">COUNTRY_NAME_AE<br>undefined, undefined<br>undefined undefined</div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Phone Number</div><div class=\"address-card__row-content\">888</div></div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Email Address</div><div class=\"address-card__row-content\">thbbb@gmail.com</div></div></div></div><div class=\"card address-card order-success__address\"><div class=\"card__loader\"></div><div class=\"address-card__badge tag-badge tag-badge--theme\">Billing Address</div><div class=\"address-card__body\"><div class=\"address-card__name\">bbb nnn</div><div class=\"address-card__row\">COUNTRY_NAME_AE<br>undefined, undefined<br>undefined undefined</div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Phone Number</div><div class=\"address-card__row-content\">888</div></div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Email Address</div><div class=\"address-card__row-content\">thbbb@gmail.com</div></div></div></div></div></div>`\n\n\n{\n  /* <div class=\"order-success__body\"><div class=\"order-success__header\"><svg class=\"order-success__icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"100\" height=\"100\"><path d=\"M50 100C22.4 100 0 77.6 0 50S22.4 0 50 0s50 22.4 50 50-22.4 50-50 50zm0-98C23.5 2 2 23.5 2 50s21.5 48 48 48 48-21.5 48-48S76.5 2 50 2zm-5.8 69L22.3 49.1l1.4-1.4 21.2 21.2 34.4-34.4 1.4 1.4L45.6 71c-.4.4-1 .4-1.4 0z\"></path></svg><h1 class=\"order-success__title\">Thank you</h1><div class=\"order-success__subtitle\">Your order has been received</div><div class=\"order-success__actions\"><a class=\"btn btn-sm btn-secondary\" href=\"/\">Go To Homepage</a></div></div><div class=\"card order-success__meta\"><ul class=\"order-success__meta-list\"><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Enquiry number:</span><span class=\"order-success__meta-value\">#9479</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Created At:</span><span class=\"order-success__meta-value\">Dec 23, 2020</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Total:</span><span class=\"order-success__meta-value\">AED85.00</span></li><li class=\"order-success__meta-item\"><span class=\"order-success__meta-title\">Payment Method:</span><span class=\"order-success__meta-value\"></span></li></ul></div><div class=\"card\"><div class=\"order-list\"><table><thead class=\"order-list__header\"><tr><th class=\"order-list__column-label\" colspan=\"2\">Product</th><th class=\"order-list__column-quantity\">Quantity</th><th class=\"order-list__column-total\">Total</th></tr></thead><tbody class=\"order-list__products\"><tr><td class=\"order-list__column-image\"><div class=\"image image--type--product\"><a class=\"image__body\" href=\"/products/ENGINE-OIL-BMW-5W30\"> </a></div></td><td class=\"order-list__column-product\"><a href=\"/products/ENGINE-OIL-BMW-5W30\">ENGINE OIL BMW 5W30</a><div class=\"order-list__options\"><ul class=\"order-list__options-list\"><li class=\"order-list__options-item\"><span class=\"order-list__options-label\">Material: </span><span class=\"order-list__options-value\">Aluminium</span></li><li class=\"order-list__options-item\"><span class=\"order-list__options-label\">Color: </span><span class=\"order-list__options-value\">Yellow</span></li></ul></div></td><td class=\"order-list__column-quantity\" data-title=\"Quantity:\">1</td><td class=\"order-list__column-total\">AED25.00</td></tr><tr><td class=\"order-list__column-image\"><div class=\"image image--type--product\"><a class=\"image__body\" href=\"/products/ENGINE-OIL-BMW-5W30\"> </a></div></td><td class=\"order-list__column-product\"><a href=\"/products/ENGINE-OIL-BMW-5W30\">ENGINE OIL BMW 5W30</a></td><td class=\"order-list__column-quantity\" data-title=\"Quantity:\">1</td><td class=\"order-list__column-total\">AED25.00</td></tr></tbody><tbody class=\"order-list__subtotals\"><tr><th class=\"order-list__column-label\" colspan=\"3\">Subtotal</th><td class=\"order-list__column-total\">AED50.00</td></tr><tr><th class=\"order-list__column-label\" colspan=\"3\">Shipping</th><td class=\"order-list__column-total\">AED25.00</td></tr><tr><th class=\"order-list__column-label\" colspan=\"3\">Tax</th><td class=\"order-list__column-total\">AED10.00</td></tr></tbody><tfoot class=\"order-list__footer\"><tr><th class=\"order-list__column-label\" colspan=\"3\">Total</th><td class=\"order-list__column-total\">AED85.00</td></tr></tfoot></table></div></div><div class=\"order-success__addresses\"><div class=\"card address-card order-success__address\"><div class=\"card__loader\"></div><div class=\"address-card__badge tag-badge tag-badge--theme\">Shipping Address</div><div class=\"address-card__body\"><div class=\"address-card__name\">bbb nnn</div><div class=\"address-card__row\">COUNTRY_NAME_AE<br>undefined, undefined<br>undefined undefined</div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Phone Number</div><div class=\"address-card__row-content\">888</div></div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Email Address</div><div class=\"address-card__row-content\">thbbb@gmail.com</div></div></div></div><div class=\"card address-card order-success__address\"><div class=\"card__loader\"></div><div class=\"address-card__badge tag-badge tag-badge--theme\">Billing Address</div><div class=\"address-card__body\"><div class=\"address-card__name\">bbb nnn</div><div class=\"address-card__row\">COUNTRY_NAME_AE<br>undefined, undefined<br>undefined undefined</div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Phone Number</div><div class=\"address-card__row-content\">888</div></div><div class=\"address-card__row\"><div class=\"address-card__row-title\">Email Address</div><div class=\"address-card__row-content\">thbbb@gmail.com</div></div></div></div></div></div> */\n}\nexport { sendEmail };","map":null,"metadata":{},"sourceType":"module"}