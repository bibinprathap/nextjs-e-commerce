{"ast":null,"code":"import { products } from '~/fake-server/database/products';\nimport { addresses } from '~/fake-server/database/addresses';\nimport { makeIdGenerator } from '~/fake-server/utils';\nexport const getNextOrderId = makeIdGenerator();\nexport function getOrderToken(orderId) {\n  const token = 'b84486c31644eac99f6909a6e8c19109';\n  return token.slice(0, token.length - orderId.toString().length) + orderId.toString();\n}\n\nfunction makeOrders(defs) {\n  return defs.map(def => {\n    const id = getNextOrderId();\n    const items = def.items.map(orderItemDef => {\n      const product = products.find(x => x.slug === orderItemDef.product);\n\n      if (!product) {\n        throw new Error('Product not found');\n      }\n\n      return {\n        product: JSON.parse(JSON.stringify(product)),\n        options: orderItemDef.options,\n        price: product.price,\n        quantity: orderItemDef.quantity,\n        total: product.price * orderItemDef.quantity\n      };\n    });\n    const quantity = items.reduce((acc, item) => acc + item.quantity, 0);\n    const subtotal = items.reduce((acc, item) => acc + item.total, 0);\n    const totals = [{\n      title: 'SHIPPING',\n      price: 25\n    }, {\n      title: 'TAX',\n      price: Math.round(subtotal * 0.2)\n    }];\n    const total = subtotal + totals.reduce((acc, x) => acc + x.price, 0);\n    return {\n      id,\n      token: getOrderToken(id),\n      number: def.number,\n      createdAt: def.createdAt,\n      payment: def.payment,\n      status: def.status,\n      items,\n      quantity,\n      subtotal,\n      totals,\n      total,\n      shippingAddress: JSON.parse(JSON.stringify(addresses[0])),\n      billingAddress: JSON.parse(JSON.stringify(addresses[0]))\n    };\n  });\n}\n\nconst ordersDef = [{\n  number: '9478',\n  createdAt: '2020-10-19',\n  payment: 'PayPal',\n  status: 'PENDING',\n  items: [{\n    product: 'Nissan-headlight',\n    options: [{\n      name: 'Color',\n      value: 'True Red'\n    }, {\n      name: 'Material',\n      value: 'Aluminium'\n    }],\n    quantity: 2\n  }, {\n    product: 'ENGINE-OIL-BMW-5W30',\n    options: [],\n    quantity: 1\n  }, {\n    product: 'ENGINE-OIL-5W-40',\n    options: [{\n      name: 'Color',\n      value: 'Green'\n    }],\n    quantity: 3\n  }]\n}, {\n  number: '7592',\n  createdAt: '2019-03-28',\n  payment: 'PayPal',\n  status: 'PENDING',\n  items: [{\n    product: 'INJECTOR-CLEANER',\n    options: [{\n      name: 'Color',\n      value: 'True Red'\n    }, {\n      name: 'Material',\n      value: 'Aluminium'\n    }],\n    quantity: 2\n  }, {\n    product: 'SPARK-PLUG-06H905601A',\n    options: [],\n    quantity: 1\n  }]\n}, {\n  number: '7192',\n  createdAt: '2019-03-15',\n  payment: 'PayPal',\n  status: 'SHIPPED',\n  items: [{\n    product: 'BRAKE-PAD',\n    options: [],\n    quantity: 5\n  }, {\n    product: 'MOBIL-1-1-LITER-ENGINE-OIL',\n    options: [],\n    quantity: 1\n  }]\n}, {\n  number: '6321',\n  createdAt: '2019-02-28',\n  payment: 'PayPal',\n  status: 'COMPLETED',\n  items: [{\n    product: 'ENGINE-OIL-5W-40',\n    options: [],\n    quantity: 1\n  }]\n}, {\n  number: '6001',\n  createdAt: '2019-02-21',\n  payment: 'PayPal',\n  status: 'COMPLETED',\n  items: [{\n    product: 'SENSOR',\n    options: [],\n    quantity: 7\n  }, {\n    product: 'BRAKE-PAD-5N0698151',\n    options: [],\n    quantity: 1\n  }]\n}, {\n  number: '4120',\n  createdAt: '2018-12-11',\n  payment: 'PayPal',\n  status: 'COMPLETED',\n  items: [{\n    product: 'OIL-FILTER-06D115562',\n    options: [],\n    quantity: 1\n  }]\n}];\nexport const orders = makeOrders(ordersDef);\nexport function getNextOrderNumber() {\n  return (orders.reduce((prev, curr) => Math.max(prev, parseFloat(curr.number)), 0) + 1).toString();\n}","map":null,"metadata":{},"sourceType":"module"}