{"ast":null,"code":"// application\nimport { shopApi } from '~/api';\nimport { QUICKVIEW_CLOSE, QUICKVIEW_OPEN } from '~/store/quickview/quickviewActionTypes';\n\nlet cancelPreviousRequest = () => {};\n\nexport function quickviewOpenSuccess(product) {\n  return {\n    type: QUICKVIEW_OPEN,\n    product\n  };\n}\nexport function quickviewClose() {\n  return {\n    type: QUICKVIEW_CLOSE\n  };\n}\nexport function quickviewOpen(productSlug) {\n  return dispatch => {\n    cancelPreviousRequest();\n    return new Promise(resolve => {\n      let canceled = false; // sending request to server, timeout is used as a stub\n\n      const timer = setTimeout(() => {\n        shopApi.getProductBySlug(productSlug).then(product => {\n          if (canceled) {\n            return;\n          }\n\n          if (product) {\n            dispatch(quickviewOpenSuccess(product));\n          }\n\n          resolve();\n        });\n      }, 250);\n\n      cancelPreviousRequest = () => {\n        canceled = true;\n        clearTimeout(timer);\n        resolve();\n      };\n    });\n  };\n}","map":null,"metadata":{},"sourceType":"module"}