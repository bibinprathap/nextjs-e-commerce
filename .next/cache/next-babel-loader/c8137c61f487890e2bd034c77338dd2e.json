{"ast":null,"code":"var __jsx = React.createElement;\n// react\nimport React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nfunction Collapse(props) {\n  var toggleClass = props.toggleClass,\n      render = props.render,\n      open = props.open;\n\n  var _useState = useState(false),\n      init = _useState[0],\n      setInit = _useState[1];\n\n  var itemRef = useRef(null);\n  var contentRef = useRef(null);\n  var expand = useCallback(function () {\n    var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var item = itemRef.current;\n    var content = contentRef.current || item;\n\n    if (!item || !content) {\n      return;\n    }\n\n    if (immediate) {\n      item.classList.add(toggleClass);\n      content.style.height = '';\n    } else {\n      var startHeight = content.getBoundingClientRect().height;\n      item.classList.add(toggleClass);\n      var endHeight = content.getBoundingClientRect().height;\n      content.style.height = \"\".concat(startHeight, \"px\");\n      content.getBoundingClientRect(); // force reflow\n\n      content.style.height = \"\".concat(endHeight, \"px\");\n\n      if (content.getBoundingClientRect().height === endHeight) {\n        content.style.height = '';\n      }\n    }\n  }, [toggleClass, itemRef, contentRef]);\n  var collapse = useCallback(function () {\n    var immediate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    var item = itemRef.current;\n    var content = contentRef.current || item;\n\n    if (!item || !content) {\n      return;\n    }\n\n    if (immediate) {\n      item.classList.remove(toggleClass);\n      content.style.height = '';\n    } else {\n      var startHeight = content.getBoundingClientRect().height;\n      content.style.height = \"\".concat(startHeight, \"px\");\n      item.classList.remove(toggleClass);\n      content.getBoundingClientRect(); // force reflow\n\n      content.style.height = '';\n    }\n  }, [toggleClass, itemRef, contentRef]);\n  var handleToggle = useCallback(function () {\n    var item = itemRef.current;\n\n    if (!item) {\n      return;\n    }\n\n    if (item.classList.contains(toggleClass)) {\n      collapse();\n    } else {\n      expand();\n    }\n  }, [expand, collapse, toggleClass, itemRef]);\n  useEffect(function () {\n    if (typeof open === 'boolean') {\n      if (open) {\n        expand(!init);\n      } else {\n        collapse(!init);\n      }\n    }\n\n    setInit(true);\n  }, [expand, collapse, open, init]);\n  useEffect(function () {\n    var item = itemRef.current;\n    var content = contentRef.current || item;\n\n    if (!content) {\n      return function () {};\n    }\n\n    var handleTransitionEnd = function handleTransitionEnd(event) {\n      if (content && event.propertyName === 'height') {\n        content.style.height = '';\n      }\n    };\n\n    content.addEventListener('transitionend', handleTransitionEnd);\n    return function () {\n      if (!content) {\n        return;\n      }\n\n      content.removeEventListener('transitionend', handleTransitionEnd);\n    };\n  }, []);\n  return useMemo(function () {\n    if (render) {\n      return __jsx(React.Fragment, null, render({\n        toggle: handleToggle,\n        setItemRef: itemRef,\n        setContentRef: contentRef\n      }));\n    }\n\n    return null;\n  }, [render, handleToggle, itemRef, contentRef]);\n}\n\nexport default Collapse;","map":null,"metadata":{},"sourceType":"module"}